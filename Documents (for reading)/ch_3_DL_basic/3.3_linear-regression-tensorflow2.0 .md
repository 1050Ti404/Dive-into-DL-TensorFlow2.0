

# 线性回归的简洁实现

随着深度学习框架的发展，开发深度学习应用变得越来越便利。实践中，我们通常可以用比上一节更简洁的代码来实现同样的模型。在本节中，我们将介绍如何使用tensorflow2.0推荐的keras接口更方便地实现线性回归的训练。

## 生成数据集

我们生成与上一节中相同的数据集。其中`features`是训练数据特征，`labels`是标签。


```python
import tensorflow as tf
num_inputs = 2
num_examples = 1000
true_w = [2, -3.4]
true_b = 4.2
features = tf.random.normal([num_examples, num_inputs],mean=0,stddev=1)
labels = true_w[0] * features[:, 0] + true_w[1] * features[:, 1] + true_b
labels += tf.random.normal(labels.shape,0,1)
print(features[0], labels[0])
```

    tf.Tensor([-0.31142414  1.185783  ], shape=(2,), dtype=float32) tf.Tensor(-1.7691664, shape=(), dtype=float32)
    

虽然tensorflow2.0对于线性回归可以直接拟合，不用再划分数据集，但我们仍学习一下读取数据的方法


```python
dataset=tf.data.Dataset.from_tensor_slices((features,labels))
train_db = tf.data.Dataset.from_tensor_slices((features, labels)).batch(10)
for(x,y) in train_db:
    print(x,y)
```

    tf.Tensor(
    [[-0.31142414  1.185783  ]
     [ 0.4031657  -1.5191373 ]
     [-3.569118   -0.6842313 ]
     [ 0.71019626  0.5446973 ]
     [ 0.31990707  1.7573819 ]
     [-1.0312866  -0.11888162]
     [ 0.09413959 -0.38714787]
     [ 1.6867099   0.5449778 ]
     [ 0.48176482 -1.3065048 ]
     [-0.2400822  -0.31924346]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-1.7691664  10.648275    0.08068681  3.5181637  -1.6154277   2.3145227
      7.723895    6.2329636   9.321918    4.2699337 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.1946873   0.01266051]
     [ 0.98890686 -0.21019994]
     [ 0.32030094 -0.6406062 ]
     [-1.3820813   0.71059066]
     [ 0.24790597  1.766107  ]
     [-0.7328565  -1.824104  ]
     [-1.3516273  -0.5460842 ]
     [ 1.7314373  -0.8828247 ]
     [-0.89745337  0.9458011 ]
     [-0.72289824 -1.0443094 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.8911037  5.7280293  6.9729085 -1.4666957 -2.2638824  8.610469
      3.8972516 12.173055  -3.2210565  5.451403 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.10466944 -0.11466638]
     [-0.8207273   0.8553819 ]
     [ 1.1173396   1.2036067 ]
     [ 0.4276777   1.3967142 ]
     [-0.08770848  0.41950548]
     [-0.02106858 -0.74995357]
     [-1.2110662  -0.542626  ]
     [ 2.1024044   1.1553276 ]
     [ 0.14046328  1.8966042 ]
     [ 1.4005632  -0.01560731]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 4.3403087   0.30721188  2.2585738   0.65952563  0.5055094   6.074356
      4.125207    5.213072   -1.2676189   7.6693745 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.77598023  0.0207109 ]
     [-0.239604    0.35804024]
     [-0.19935757  0.9539991 ]
     [-0.02096528 -0.11081046]
     [-0.9792108  -0.2676209 ]
     [-0.579906   -0.52296275]
     [-0.0489331   0.88302463]
     [ 0.24411593 -0.34019318]
     [-0.26348415  1.6636053 ]
     [-0.23737815 -0.5168044 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 5.8616977  4.1575522 -1.2898865  5.1554728  2.1346598  5.4657717
      0.8456738  5.2932878 -3.0703413  5.127991 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.6910524   0.31613526]
     [-0.5919164   0.4897978 ]
     [-0.25202596  1.3742788 ]
     [ 1.0363053  -0.5929027 ]
     [ 0.03125923  0.9704671 ]
     [ 1.8536607  -2.0166497 ]
     [-0.74685013 -0.34496498]
     [ 0.78280157 -0.6585653 ]
     [ 0.07287292  0.31954098]
     [-0.25806817  1.0962309 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 5.771657   1.2201872 -0.7537598  7.257021   1.679185  15.616008
      3.9688578  7.1953526  3.696898   1.6800948], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.6971604   1.7130586 ]
     [ 0.917295   -1.7554392 ]
     [-0.76776636  1.9265256 ]
     [ 0.10425533  0.6334439 ]
     [ 0.00959031 -1.0253608 ]
     [ 0.26878756 -0.31771353]
     [-0.36976272 -0.08380572]
     [-0.46779057 -0.63541234]
     [-2.0032446   1.0815859 ]
     [ 1.0945683   1.3470969 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-3.7764003 10.780921  -1.7526758  0.8270123  5.915044   6.5732474
      3.6439898  4.360655  -4.842778   0.6247324], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.0018011  -1.5188915 ]
     [-0.2732027   0.2665568 ]
     [ 1.8666534  -0.02731755]
     [-1.225399    0.9951658 ]
     [ 1.6138936  -0.45919016]
     [-0.75403    -1.3399445 ]
     [-0.583605    1.0917473 ]
     [ 1.4562008  -0.36905807]
     [ 1.2738707  -0.28945488]
     [ 0.36705095 -1.3455204 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 6.155368    2.7908106   6.261793    0.22026026 11.71421     6.3852415
     -0.46330157  8.826408    6.382406   10.030694  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.4251347   1.7192396 ]
     [-0.4094293  -1.0089709 ]
     [ 1.4643289  -1.0897292 ]
     [ 2.1367216  -1.3189286 ]
     [-0.22425115  0.57771856]
     [-0.65958595  0.53766215]
     [ 0.24399833 -1.2531664 ]
     [ 0.36177516  1.8193005 ]
     [ 1.191353   -2.1431277 ]
     [ 0.55383223  0.78882366]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-0.30856386  7.571992   11.678451   11.31454     1.3031204   2.8116171
     10.54976     0.6359954  14.492693    1.8543913 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.7082558  -1.5872743 ]
     [-1.2284386   0.91358316]
     [-0.5109487   0.36227727]
     [-0.27166075 -1.1093086 ]
     [ 0.03712251  1.1912913 ]
     [ 0.23229258 -2.0040073 ]
     [-1.0750232   1.1348516 ]
     [ 0.10554883 -0.47812667]
     [ 0.440747    1.234323  ]
     [ 1.3405465  -0.20944555]], shape=(10, 2), dtype=float32) tf.Tensor(
    [11.898832   -0.9680711   0.79959667  7.0777397  -1.6198674  11.490475
     -2.3321497   5.385968    0.42231435  7.4367766 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.46406463  0.4819475 ]
     [ 1.8881361   0.7634238 ]
     [-0.69164985  1.5644851 ]
     [ 0.8696041  -0.10572295]
     [ 1.3216662  -0.9574455 ]
     [-0.48364818 -0.5028901 ]
     [-1.1711192   0.71737516]
     [-1.0932357   0.8494204 ]
     [-0.06344838  0.3111113 ]
     [ 0.84047663  0.6799805 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 1.3213701   8.046635   -2.90172     6.132778    9.212594    6.005542
     -0.20842937  0.02436596  3.0221705   4.0801754 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.12330511  0.38459677]
     [ 0.22491346 -0.96351284]
     [-2.682667    0.6768822 ]
     [-2.2078779   0.32767335]
     [ 0.7212529   0.22392052]
     [ 0.10073005 -1.1919602 ]
     [ 0.10875112  0.54155004]
     [ 1.1902493   0.95496464]
     [-0.77393454  0.78294396]
     [-2.0783305  -0.05138024]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 2.0877213   8.637093   -1.8628184  -0.7237458   4.095968    8.77597
      0.976771    2.4036865  -0.38984096 -0.25574014], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.6208643   0.718316  ]
     [ 0.01220001  0.19300033]
     [-0.81108224  0.8121146 ]
     [ 0.72922486 -1.3639885 ]
     [-3.1241763  -1.909361  ]
     [ 0.28527024 -0.25919563]
     [ 0.09489539  0.27445585]
     [ 2.6770275   2.2230732 ]
     [ 1.3559275   0.69547516]
     [-0.01308486 -0.01889952]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.9300766  4.4553475 -1.4716077  9.892282   5.1171207  6.253634
      5.443784   2.7089229  3.587549   2.8782432], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.92931765 -0.46079364]
     [-0.8024714  -0.9556818 ]
     [-0.61174804 -1.7768662 ]
     [-1.2571255  -0.17119342]
     [-0.35113665  1.1486963 ]
     [-0.28571576  2.1508615 ]
     [-0.57591826 -0.1896578 ]
     [ 0.42014655  0.17247583]
     [-0.33435002  0.49908873]
     [ 1.3752873  -0.5196378 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.9135578   6.098067    8.766989    3.7443833  -0.81204915 -3.0921776
      5.090546    5.0867662   2.5886545   8.55792   ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.3410361   0.40024045]
     [-0.66289014 -0.6982056 ]
     [-0.17423572  0.0231803 ]
     [-0.530467   -1.0338165 ]
     [-0.6648053   0.62490046]
     [ 0.16198462 -0.35072756]
     [-0.02591369  1.0216938 ]
     [ 0.83574307  0.09663146]
     [ 0.6773044  -0.7493416 ]
     [ 1.0732089  -0.77302915]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 2.5703948  4.1727977  3.4660532  6.945525   1.9827216  6.034923
     -1.193063   4.154225  11.243639   9.024376 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.3386939  -0.547092  ]
     [ 0.19117047  0.6076362 ]
     [-0.92038184  0.6065868 ]
     [ 0.13371252 -1.0457867 ]
     [-0.73761284 -1.2785621 ]
     [ 0.0321521  -0.5979271 ]
     [-0.6370189   0.91293406]
     [ 0.54478717 -0.93508226]
     [-0.71209526 -0.9527922 ]
     [ 0.04268066 -0.84186596]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 5.0642715   1.9102015  -0.4093601   9.801668    7.1430964   5.023146
     -0.85510886  9.51095     7.1731353   5.908887  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.60557395 -0.41734016]
     [-0.61533815  0.39816478]
     [ 1.0714242   0.68882257]
     [-0.20027171  0.95591253]
     [ 0.05983336 -1.1370958 ]
     [-0.46998405 -1.0545224 ]
     [-0.29067343  2.1190789 ]
     [-1.4049709   2.0799787 ]
     [ 1.3929441  -1.9403459 ]
     [ 0.5126393   0.30565107]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 5.955414    0.23184216  3.9896817  -1.2545338   8.656933    4.7780733
     -1.5833216  -4.915964   13.651778    3.3775768 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.1558456  -1.0014205 ]
     [ 1.1018351  -0.1380932 ]
     [-0.09965323 -0.35910088]
     [ 0.02381467 -0.7777238 ]
     [-1.6384103  -0.11600569]
     [ 0.33563638 -0.03452283]
     [ 1.4845356   0.65250254]
     [ 0.36950022 -0.48538518]
     [ 1.1518992   1.5397614 ]
     [-0.71902764 -1.1191566 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [7.9116416  8.3233795  2.9649694  6.768009   0.29070437 5.724963
     5.759761   6.6373606  1.3740376  7.260307  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.27092212 -2.0629866 ]
     [ 0.4634441   0.34790868]
     [ 0.59118056  0.30346355]
     [ 0.26004556  0.19127649]
     [-0.8935519   0.37917826]
     [ 1.0967398   0.5722203 ]
     [ 0.18171404  0.58182645]
     [-0.15209386  1.8050331 ]
     [-0.69618607 -0.0398573 ]
     [ 0.7357162  -1.109623  ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [11.760756    3.0552437   4.820065    4.170794    0.50448304  5.0730586
      2.9086132  -1.2648478   2.031361   10.298351  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.7114946   1.3808001 ]
     [ 0.7180453   1.6728096 ]
     [ 1.0699322   1.558987  ]
     [-1.2711172  -1.5188801 ]
     [-0.6936328   0.5424908 ]
     [ 0.15277807  1.3802885 ]
     [ 1.0631592   0.83782035]
     [ 1.1341654   0.6697708 ]
     [-0.35723647  0.3134842 ]
     [ 0.05838063  0.30883515]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-5.5595727   0.76910496  1.3189594   5.249706    1.1666901  -0.72244895
      4.594436    3.906332    1.8917346   3.0422056 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.9101715  -0.7203218 ]
     [-0.7186486  -1.5582947 ]
     [-0.5076553   0.34984353]
     [-0.8957108   1.1492534 ]
     [ 0.5791051   1.1941555 ]
     [-0.95688915  1.2259731 ]
     [ 0.34256616 -1.7480539 ]
     [ 0.42834267  2.549036  ]
     [-0.9268894  -0.28510064]
     [ 1.1030043   0.8786635 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 9.741832   6.3427677  2.3219635 -2.1208007  1.7804943 -2.2923033
     10.772379  -4.4110513  3.1435952  4.0061107], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.7622306  -0.06892526]
     [-0.33755827  0.8182034 ]
     [-1.6257806  -2.298273  ]
     [ 0.7055403  -1.5634727 ]
     [ 1.6357061   0.7922259 ]
     [-1.1066674  -0.43665442]
     [ 1.0055447  -0.9301012 ]
     [-0.6537698   1.5910026 ]
     [-0.959534    0.98206186]
     [-2.1067915   0.2534401 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 6.800964    0.9801573   7.0798273  10.738162    4.6166334   3.0043466
      9.148955   -2.6352968  -0.26859003  0.38580728], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.22187482 -1.547462  ]
     [ 0.4730258   0.8390074 ]
     [-0.8983655  -0.61228895]
     [-0.05854107 -0.9596127 ]
     [ 0.2505895   0.02507441]
     [-0.5003442  -0.32630864]
     [ 1.2062285  -1.0017307 ]
     [ 1.0042042   0.3671029 ]
     [-1.2661287  -2.1814775 ]
     [ 0.922722   -0.87473434]], shape=(10, 2), dtype=float32) tf.Tensor(
    [9.67024   2.0394015 5.054477  8.989485  3.74507   3.6835825 9.540629
     5.7120986 7.7189074 7.656723 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.19502874 -0.93637735]
     [-1.4348772  -0.3591762 ]
     [-0.14911772 -0.14776108]
     [ 1.6610632   0.29828262]
     [-0.99546695  1.9117824 ]
     [-0.42495015  0.64401364]
     [-1.8737385   1.308718  ]
     [ 0.21662082  1.3010474 ]
     [-1.197332    0.18953471]
     [-0.29241002  0.08329894]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 6.8411393   1.5806324   5.4896846   5.9769506  -3.4245358   1.1412652
     -2.3141203  -0.97051084  2.8966208   2.52887   ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.18902999  0.7688323 ]
     [-0.5966563   1.3159189 ]
     [-1.5807636   0.96192575]
     [ 1.635983   -1.6033386 ]
     [-0.35402596 -1.0100722 ]
     [ 0.01694343 -1.0165323 ]
     [-1.3137149   0.20688882]
     [-0.50728077 -0.10146709]
     [-0.85525703 -0.18100657]
     [-0.21365799 -1.5573997 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 1.1905781 -1.4679589 -2.3692908 12.279797   4.2297273  8.723907
     -1.6230273  1.606194   4.170397  10.2212715], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.4243948  -0.31511843]
     [ 0.21834823  0.07091501]
     [-0.7784952   0.4809218 ]
     [ 0.3694326  -0.14859161]
     [ 1.1606094   0.02612559]
     [ 0.32045236  0.7041654 ]
     [-0.96131366 -0.8900108 ]
     [-0.30296934 -0.13022678]
     [ 0.70007354 -0.4067004 ]
     [ 0.15805314 -0.80997604]], shape=(10, 2), dtype=float32) tf.Tensor(
    [4.8280196  4.534541   0.40946788 4.2795777  6.794501   2.60675
     5.414682   4.065154   6.6293364  7.9028406 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.97124213  1.5131674 ]
     [ 0.21930535 -0.95576376]
     [-0.24931206 -0.24206436]
     [-0.3232324  -0.7569468 ]
     [ 1.1241674  -0.37414765]
     [ 0.43022752  2.111296  ]
     [ 1.205603   -1.3263094 ]
     [-0.78593856 -0.38426846]
     [-1.9799421  -0.4348589 ]
     [-0.16316684  1.916554  ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 0.35176557  5.7838073   3.421276    6.3541      8.288933   -0.58013296
     10.224095    4.480057    1.7144885  -1.3856076 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.5993656   0.73544204]
     [-0.06032852  0.7284632 ]
     [ 0.49226505 -0.68672115]
     [-1.0677223   2.1198347 ]
     [ 0.7979809  -0.6192639 ]
     [ 0.4094069   0.889049  ]
     [ 1.3414313   0.16646281]
     [ 0.51300156  0.20228383]
     [-0.21519117 -1.1120589 ]
     [-0.03278344 -0.9349251 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 4.789498   3.6750216  7.0668154 -6.717124   8.696866   1.6606262
      7.3321767  5.3772407  8.216904   6.3380203], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.7017118  -0.5278113 ]
     [ 0.3168778  -0.57377505]
     [ 0.3002342   1.0645611 ]
     [-1.0679837   0.3098717 ]
     [-0.16578557  1.6748466 ]
     [ 0.10605314  0.624739  ]
     [ 1.1537867   0.41677222]
     [-1.6365983   0.6271299 ]
     [-1.1675584   0.7699047 ]
     [ 1.7328694   1.7031409 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [10.277983    7.8474255   1.7241806   0.18742013 -1.3645236   3.1053333
      4.7634673  -0.72403    -0.8134294   1.6027949 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.59456676  0.35463083]
     [ 0.6893812   0.11405317]
     [-0.3311692   1.2729448 ]
     [ 0.2742845   0.04079314]
     [ 0.9886231  -0.31040505]
     [ 0.3617746  -0.06694005]
     [-1.6135277  -0.4050618 ]
     [ 1.7066648   1.0112803 ]
     [-0.7183156   0.7725431 ]
     [-0.2693812  -0.88252884]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 2.454246    5.6323204  -0.7530513   5.734184    6.336565    5.320875
      2.8548677   4.2296104  -0.79164404  5.327963  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.14043415 -1.2662767 ]
     [-1.512165   -0.16198634]
     [-0.9725395  -1.3002868 ]
     [ 0.72204286  1.7609155 ]
     [-0.79361916  0.06790154]
     [ 0.38337898 -0.14639217]
     [-0.40859568 -1.2556059 ]
     [-1.2760228  -0.05882933]
     [ 0.6916965  -0.24612805]
     [ 0.24825771 -0.87055475]], shape=(10, 2), dtype=float32) tf.Tensor(
    [8.206698   1.7101432  7.215334   0.70635355 2.6436408  4.7987833
     5.6698503  0.95847857 6.648077   7.0775537 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.249096    0.71349   ]
     [ 0.75879    -0.14444406]
     [-2.0888588  -0.45640364]
     [-0.93763226 -0.240148  ]
     [ 0.8216084   1.4062082 ]
     [-1.8327186  -0.9906834 ]
     [-0.9797175  -0.2159459 ]
     [-0.22867475  0.5858347 ]
     [ 0.1085161   1.0689007 ]
     [-0.85727066 -0.5813933 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-0.2242609   6.929196    2.4425743   3.126332    1.8222325   5.729383
      3.7435832   0.9880213  -0.48409975  5.498494  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 4.0741328e-02  1.1948901e-01]
     [ 6.5075591e-02 -2.4609587e-01]
     [ 5.0926787e-01  1.0131716e+00]
     [-1.1194813e-01 -1.5156182e+00]
     [-8.9224595e-01 -5.6286773e-04]
     [-2.5671339e+00 -3.7680948e-01]
     [ 2.9338336e-01 -8.3533657e-01]
     [-1.0569052e+00 -2.2052925e+00]
     [ 6.6955209e-01 -8.1372285e-01]
     [-2.2715521e+00 -4.6332070e-01]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.687489    4.7591205   1.1494772  10.68684     2.2616138   0.12253705
      6.235616    9.30454     8.664963    0.6093499 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.77922094 -0.19147092]
     [-0.05108964 -0.10931832]
     [-1.1394484   0.8681066 ]
     [ 0.09055797 -0.47204348]
     [-0.5746129   1.3398864 ]
     [-0.07037452 -0.09659931]
     [ 0.10143793 -0.2353214 ]
     [-0.7203832  -0.400602  ]
     [ 1.7298281   0.85376525]
     [-2.7139854   1.7341675 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 5.9267426  4.7909303 -1.9946281  7.5665927 -3.4695466  4.6367493
      5.8517976  4.3428206  3.740132  -6.665447 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.6953148   0.54742837]
     [ 2.778045   -1.8463745 ]
     [ 1.7783402   0.6491722 ]
     [-0.4879228  -2.4296618 ]
     [-0.14239067  0.7144026 ]
     [-0.87043834  0.03597856]
     [ 1.8596997   1.0537994 ]
     [ 1.0298158   1.3008404 ]
     [-1.2578894  -1.1643121 ]
     [-0.8129682  -0.17468359]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 7.0279074  16.427876    5.667673   10.197862    0.27873623  1.9030762
      4.1837945  -0.3441527   3.9133174   4.371737  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.48395532  0.09554693]
     [-0.46842998  0.53823274]
     [ 2.222509    0.09663775]
     [ 0.44301367 -0.42687792]
     [-0.5052002   1.5592221 ]
     [-1.720679    0.6749542 ]
     [-1.2700336  -0.9782997 ]
     [ 1.522298    1.4867892 ]
     [ 0.7581959  -1.180852  ]
     [-0.37874064 -1.0173825 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 1.8835729  2.3593502  8.200842   5.54123   -2.1997528 -1.7118566
      5.2148438  3.6886845  9.291422   6.9883113], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-2.2916243  -1.3048025 ]
     [-0.11106087 -0.46950424]
     [ 0.62588334  0.77159244]
     [ 1.979684   -0.13875529]
     [-0.2981555   1.4125211 ]
     [-1.7158443  -0.6297712 ]
     [ 1.7577295  -1.2231704 ]
     [-0.04719454 -0.02298494]
     [-0.90981203  0.2586002 ]
     [ 0.9216872   0.3857965 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.3293698   5.176557    4.505428    8.575017   -0.19112027  2.6324842
     12.070547    4.8184314   0.61365753  3.883863  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.34977084 -1.804903  ]
     [ 1.4457749  -0.92954445]
     [-0.36058196 -0.17078134]
     [ 1.5100759   0.04381962]
     [-0.9547948   0.54711014]
     [-2.2056007  -0.18683678]
     [-0.690639   -1.3234395 ]
     [-0.25741836  0.6513648 ]
     [ 1.0411769   0.94158167]
     [-0.01761348 -0.20294833]], shape=(10, 2), dtype=float32) tf.Tensor(
    [11.035453  10.249007   6.529007   7.338822   1.3894414  0.9092692
      6.1987824  3.3381696  2.838452   5.7849555], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.73742604  0.00855503]
     [ 0.8772751  -0.27239463]
     [-0.34423575 -0.01869008]
     [ 0.77409494  1.4349656 ]
     [ 1.1914537   0.45633626]
     [ 2.1313925  -0.01034029]
     [ 0.9664996   0.4047206 ]
     [ 0.05558036  2.3028307 ]
     [-1.1213429   0.07592358]
     [ 0.38728744 -0.50154835]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 4.5754776   6.1380076   2.1568522   0.52106684  3.7840948   9.148271
      3.7479038  -5.5140214   1.409755    6.343625  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.031488   -1.0638713 ]
     [-0.44386268 -0.2485582 ]
     [-1.7876596  -0.38436928]
     [-0.46775842  0.43143347]
     [-0.4420058  -1.4045249 ]
     [-0.96129596 -1.0189036 ]
     [-0.51188046 -0.34235054]
     [ 0.25947535 -0.58209455]
     [-0.706804    0.3607731 ]
     [-1.3603749  -0.39664203]], shape=(10, 2), dtype=float32) tf.Tensor(
    [10.535959   2.5587244  2.5993867  2.4407642  5.87772    5.122925
      1.7051992  7.0315146  1.0983171  2.658211 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.2385317   0.1349882 ]
     [-1.7389957   1.1245955 ]
     [ 0.7813617   1.056881  ]
     [-1.0212682   0.25227138]
     [-0.20835476  2.7548277 ]
     [-0.7820722  -1.0344818 ]
     [ 0.4494721  -0.6606569 ]
     [-1.7769265   0.6730527 ]
     [-0.35071045  0.3776672 ]
     [ 0.5327911   1.4712735 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 1.3610921  -3.5913732   2.7183297  -0.7599962  -4.000757    6.4260416
      7.8307366  -2.0583658   0.8273281  -0.56736296], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.6255903   1.9858019 ]
     [-1.9276755  -0.7277633 ]
     [-0.07076703  1.2495792 ]
     [-0.9309057  -2.236433  ]
     [-0.80350167 -0.6381969 ]
     [ 2.3819485   1.2238327 ]
     [ 0.04692451 -1.5808463 ]
     [ 0.22477362  1.3735958 ]
     [-0.2502065   0.7220149 ]
     [ 0.45102817  1.708861  ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-1.8682221   2.6790805   0.27043495  9.890529    4.4713645   5.3184314
     10.618948   -0.37269452  1.3001814  -1.0079252 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.6925397   0.9343641 ]
     [ 0.75469065  0.41921386]
     [-1.064554    0.643764  ]
     [ 0.01400228  0.85028183]
     [ 0.9845993  -0.09384736]
     [ 0.42522654  0.55648166]
     [-1.1300896   0.31301966]
     [ 0.18159543  0.46893483]
     [ 0.74744624 -1.0147142 ]
     [-1.1372863  -1.2417288 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 0.30232996  4.1068163  -0.19909498  3.1792502   4.9539995   1.0339541
      1.5665411   5.1427565   9.450441    6.7040358 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-3.0646138  -0.17596807]
     [-0.879308    0.02524549]
     [-0.68822086 -0.8418387 ]
     [ 0.30934882 -0.6311486 ]
     [ 1.9610443  -0.8950987 ]
     [-1.0604467  -0.65170634]
     [-1.0979561   0.20180278]
     [ 1.165053    1.1511323 ]
     [-1.3008604  -0.7382497 ]
     [-0.6329353   0.30715257]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-2.088863   2.416283   6.8383765  6.3836613 10.606895   2.7054112
      2.0000281  2.4663973  4.225881   2.4712768], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.41157004  0.561064  ]
     [-0.3971141   0.6266826 ]
     [-0.28206632  0.32196793]
     [ 0.72318614 -0.7149607 ]
     [ 0.16459897  0.6365779 ]
     [ 2.341313   -1.045814  ]
     [ 0.6656181  -0.5734492 ]
     [ 0.15307432 -0.05605315]
     [ 0.66426134  0.9091561 ]
     [-1.480503    0.2601035 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 0.6810806   2.4184523   1.7105892   8.466802    3.9124393  10.867882
      8.579808    3.773085    4.5651536   0.40816417], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.1952832   0.40947083]
     [-0.17191143  2.4720874 ]
     [ 0.9886131  -1.1085539 ]
     [ 0.02794511  2.5429547 ]
     [-0.18981317  0.82503176]
     [ 0.14690082 -0.37737235]
     [ 1.621445    0.53609353]
     [ 0.01704438 -0.8459768 ]
     [-2.2773764  -0.19197853]
     [ 0.8876894  -0.48201025]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 0.27814114 -3.6180246  10.7818985  -4.7728553   0.32847506  6.2711167
      5.918109    9.356266    0.58086765  8.860634  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.3374594   1.4862431 ]
     [-2.37134    -1.4851875 ]
     [-0.14881553 -0.32572538]
     [-0.02164611  0.6879684 ]
     [-0.38955396 -0.03362245]
     [-0.33723027 -0.64683294]
     [ 0.31812367 -1.7454842 ]
     [ 0.5604956   0.23457763]
     [ 0.4040196  -0.6250267 ]
     [ 0.81409335 -0.38344634]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 0.11884749  5.9610434   5.7180996   1.6031605   2.7311795   4.317635
     10.247631    5.507713    7.399168    6.8557005 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.29424322  0.9558656 ]
     [-0.8227164  -0.78838444]
     [ 1.1847941   0.28384158]
     [-0.964674    1.357562  ]
     [ 0.80223775 -1.2699844 ]
     [-0.40593097  1.0086406 ]
     [ 0.32906094  1.4269478 ]
     [ 1.7159381   0.73120177]
     [-0.28997335  2.1137357 ]
     [-0.13748725  0.4787587 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 0.52811277  5.3000674   4.37488    -2.150102   10.032337   -1.1425364
     -1.346937    4.2935157  -4.918814    2.3550382 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.42841536  0.34578103]
     [ 0.8620382  -0.80128837]
     [-0.629562    0.8758173 ]
     [ 2.1881473  -0.46439555]
     [-0.12957838 -0.12064622]
     [ 0.31193188  0.5280351 ]
     [ 0.20172797 -0.4796662 ]
     [-0.10014546  0.05454298]
     [-0.1343204   0.34088528]
     [ 0.08195629 -0.795697  ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [4.0309024 7.9635944 1.4656478 9.856905  3.8629818 3.691063  5.78115
     4.889272  4.039149  5.6269073], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.4256314  -1.254319  ]
     [ 1.3442227   0.9166598 ]
     [-0.6425585   1.7574229 ]
     [-1.5401648  -0.3450158 ]
     [-2.3077528  -0.8115233 ]
     [ 0.00475167  0.573473  ]
     [-1.0625631  -0.98233795]
     [ 1.2414953   1.5870221 ]
     [ 0.9648495   0.5729152 ]
     [ 1.5917302  -0.29335922]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 8.546501    4.2456484  -4.687459    1.5438404   1.6763443   2.9068422
      5.060415    0.47935605  4.159633    7.9320936 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.2258893  -0.8619141 ]
     [-0.5489829  -0.77980363]
     [-0.9204238  -0.8322781 ]
     [ 1.0788116   0.21803854]
     [-0.43308103 -0.3311653 ]
     [-0.28423873 -0.5441141 ]
     [-0.10506873 -0.28028712]
     [-0.01052528  0.04968084]
     [-0.8793136   0.01796822]
     [ 1.5585821  -0.2723774 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [5.7410226 5.304     6.4682026 5.3855925 3.8595548 5.507171  3.1749027
     3.1736965 1.716898  8.289918 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.148963   -0.56573147]
     [ 0.21645401 -0.8562893 ]
     [-0.57557595 -0.6560774 ]
     [-0.2044607   0.5586596 ]
     [ 0.09036916 -1.1955856 ]
     [ 0.5914356  -0.00185127]
     [-1.0542127  -0.34280977]
     [ 1.1263132  -0.21414657]
     [-1.3518476  -1.7528572 ]
     [-0.1782866   0.29049805]], shape=(10, 2), dtype=float32) tf.Tensor(
    [8.85338   7.101613  3.725472  0.9677305 8.721218  5.543452  2.7296846
     9.4566555 7.3433285 2.4131286], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.3335645   0.0744973 ]
     [ 0.5918011   1.5131742 ]
     [-0.28136343 -1.2370046 ]
     [-0.5526555   0.5027982 ]
     [ 0.0292226   0.30804965]
     [ 0.43775624  0.30840772]
     [-0.66975206 -1.85623   ]
     [-1.3106587  -0.09711006]
     [ 0.31478873  1.0647494 ]
     [ 1.1761943   0.84627813]], shape=(10, 2), dtype=float32) tf.Tensor(
    [5.964194   0.13491863 6.594536   2.5034137  4.2088776  2.7201853
     9.29848    1.3804679  0.69787276 2.4855957 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.36402744 -0.5813858 ]
     [-0.19493656  1.065368  ]
     [ 0.36361182 -0.06977815]
     [ 0.16623619  0.3394951 ]
     [-1.0086898   0.208826  ]
     [ 0.11045489 -1.2076094 ]
     [-1.2040676  -2.2759755 ]
     [ 0.31934044 -0.00991334]
     [ 0.58034474 -1.3288933 ]
     [-0.7207311  -0.0515286 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 6.1024466 -0.3676582  5.1024666  3.8476849  2.8324394  8.866692
     11.128654   5.0191674 10.218622   1.8901966], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.016148    0.22338651]
     [ 0.17199859  1.5856353 ]
     [ 1.5803869   0.69852704]
     [ 0.47162983  0.02055776]
     [-0.5661488   1.8651247 ]
     [-1.0520145  -0.39413834]
     [-0.7803787   1.6217607 ]
     [ 1.3643667  -0.7215041 ]
     [ 1.6228497  -0.55417174]
     [-1.4189484   0.4628023 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 0.81175256 -0.70661646  6.739164    3.8666978  -3.7717214   2.2503295
     -1.6805456   9.919328   10.702062   -1.9835613 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.5240153  -2.0796497 ]
     [-1.1758004  -1.922998  ]
     [ 0.57733744  0.79640776]
     [ 0.9852363  -0.07487269]
     [ 0.55918163  0.8707269 ]
     [-0.5089401   0.57325906]
     [-0.05834134  0.24150404]
     [-0.37827793 -0.03640415]
     [ 0.06722932  0.1394135 ]
     [-0.6461037   0.04868226]], shape=(10, 2), dtype=float32) tf.Tensor(
    [10.135871   9.7041     4.1465783  5.751249   2.7915683  1.7366254
      3.162084   4.4329205  4.688856   3.0797617], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.95422184 -0.8985332 ]
     [-0.63883317 -0.3067301 ]
     [ 1.0187223   1.2811073 ]
     [ 0.38675284 -0.1456857 ]
     [-1.1440216  -1.375803  ]
     [-1.3789047  -1.3311568 ]
     [ 0.10211933  0.8515184 ]
     [-0.5826511  -1.0506517 ]
     [ 2.5297654  -0.86512274]
     [-1.5860169  -0.11230592]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 8.69477     3.3290677   2.0588274   4.929212    6.521912    4.2182755
      0.7484207   6.585613   12.3594885  -0.24942958], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.43623394  0.10835496]
     [ 1.0941379   0.645017  ]
     [-0.16847257 -1.476375  ]
     [ 1.6089894   0.60465455]
     [-0.7007716  -0.91142046]
     [ 0.57178426 -0.7521364 ]
     [-1.1896905   0.02369085]
     [ 1.4243661  -1.0760919 ]
     [ 0.87844604  1.5551959 ]
     [ 1.3809074  -1.2328516 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 4.887577    2.0697913  10.9939165   5.3136      6.867231    8.00694
      0.16442478 10.312267   -0.5468786  11.21449   ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.5649438  -1.5221947 ]
     [ 0.66333693 -1.357102  ]
     [-1.1303277   1.4409735 ]
     [-0.8908712   0.6314088 ]
     [-1.1474177   0.22223476]
     [ 0.3267061   0.01805769]
     [ 0.91784567 -0.0959933 ]
     [-1.2736015  -0.43652782]
     [-0.06248191  0.4334838 ]
     [-1.108746    0.51090777]], shape=(10, 2), dtype=float32) tf.Tensor(
    [10.703426   10.718354   -1.4752637   0.5509404   0.5668982   3.6218731
      6.7340784   2.8323703   3.0510678  -0.10539922], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.8168825  -1.2673107 ]
     [-0.07102402  0.63544303]
     [-0.15815866 -1.2781554 ]
     [-1.1801748   0.7060256 ]
     [-0.1326905   0.6329571 ]
     [-2.2954311  -0.21813735]
     [ 0.970002   -1.7047346 ]
     [ 0.6334018  -0.8851843 ]
     [ 1.0966631  -0.86512214]
     [-1.6118345  -0.07653446]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 8.788658    2.4273498   8.163343   -1.5418098   2.4895632   0.02585921
      9.235485    9.670643    8.806234    1.8428819 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.482518   -0.10190414]
     [ 0.97560287  1.2236501 ]
     [-1.4122912   0.23987561]
     [ 1.7522742   1.2043215 ]
     [ 0.3305035  -1.5158739 ]
     [ 0.39362913  1.8532805 ]
     [ 1.1242495  -0.6983464 ]
     [-1.7074175   0.72558916]
     [ 1.814924   -0.20673077]
     [-1.1677563  -0.3770136 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 0.32571578  2.1841764   1.7944692   4.307252   11.511982   -0.49979746
      8.507588   -0.88682896  7.844876    2.8248587 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 2.019573   -0.30114162]
     [ 1.0447901   0.2723024 ]
     [ 1.169817    0.7159657 ]
     [-0.4741866  -1.1041101 ]
     [ 0.9468674  -0.14419891]
     [ 0.7133669  -0.16885819]
     [-1.0390475  -0.01584988]
     [ 0.38792384 -0.20612694]
     [-0.05199057 -0.36314175]
     [-0.3568741  -0.2260308 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [8.572205  5.913892  3.8185165 7.7204194 6.357723  6.792704  3.8835711
     6.2529387 5.168229  3.308066 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.22047211  0.5517983 ]
     [ 0.09994851 -0.15488131]
     [ 0.27638552  0.10340364]
     [-0.7724211   0.17052476]
     [-0.7313262   1.160334  ]
     [ 1.0662038   0.93526506]
     [-0.80896205 -1.02406   ]
     [ 1.1758517   0.810852  ]
     [ 0.60375684 -0.7903915 ]
     [-0.00596503  0.60616326]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 1.4660633  5.144251   5.2144856  1.982553  -0.7618401  4.661438
      4.6959105  3.4601083  9.23758    1.9314904], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.43125758  0.35647807]
     [-0.66928005 -1.3091855 ]
     [ 0.5810834  -1.3119909 ]
     [-2.0696185   0.510196  ]
     [-0.42494503 -0.34486553]
     [ 1.3456365   0.8299038 ]
     [ 0.3300232  -0.20703107]
     [ 1.6214837  -1.4739887 ]
     [ 0.5579866  -0.12415956]
     [-1.4659616   0.2477467 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 0.2585249   8.216623    9.473435   -3.089037    4.286591    1.576098
      6.1075087  13.389464    7.60233     0.60463786], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.44356284  0.43838245]
     [-0.6745206   0.7900526 ]
     [-0.9192558   0.41218695]
     [-0.3011882  -0.593804  ]
     [-0.35334513  0.7129814 ]
     [ 1.2247841  -2.4048946 ]
     [-0.8949446  -0.64300674]
     [ 0.00919252  0.9301517 ]
     [-0.43455273 -0.8717053 ]
     [-0.92212313  1.1242194 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 2.4639978  -2.3244293   0.46350193  5.2095466  -0.7727314  14.889976
      4.0454493   1.8831236   6.9587145  -1.9113134 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.9440458   1.5848699 ]
     [ 1.5224358   0.34520835]
     [ 1.1407554   0.91921633]
     [ 0.28909013 -1.1396973 ]
     [-0.88958806  1.6324931 ]
     [ 0.50859064 -0.37911305]
     [ 0.29565442 -0.5840362 ]
     [ 1.2043155  -0.9974519 ]
     [ 1.9925761  -0.36461622]
     [-0.08268174  0.03439507]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-4.093974   4.778659   3.0531383  7.935856  -4.019705   7.771519
      5.6959066 10.665212  10.120378   5.7424483], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 2.365262   -1.0127352 ]
     [-0.5478854  -0.21467501]
     [-1.1118344  -0.9312063 ]
     [ 0.20924649  0.6787892 ]
     [-2.4292822   0.33140716]
     [-0.7533652  -1.3550946 ]
     [ 0.98736966 -0.49477485]
     [ 0.13694096 -1.1693314 ]
     [-1.5169041   1.5740421 ]
     [ 0.7987072   1.776289  ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [12.359575    3.1407413   3.7244196  -0.16423774 -2.3944848   7.033119
      8.094157    8.370098   -3.6355867  -0.47930872], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.6444962   0.9848443 ]
     [-0.38003856 -1.7560523 ]
     [-0.5599923  -0.34853727]
     [ 0.5081874   0.08914888]
     [ 0.67218107 -0.17454086]
     [ 1.8232914  -0.49687535]
     [-0.19897757  1.4581851 ]
     [ 0.8054537  -0.9602886 ]
     [-1.0485913   0.9864355 ]
     [-1.7192527   0.6737515 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 5.333476    8.060019    4.5645556   5.59242     7.1330748   9.089801
     -1.4489734  10.235056   -2.9517484  -0.64620805], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-5.8808982e-01 -2.8421727e-01]
     [ 1.1346084e+00  1.7456138e+00]
     [ 8.2733542e-01  5.6673491e-01]
     [-5.2978933e-01  5.4550582e-01]
     [-1.1454281e+00  4.6468526e-01]
     [ 4.6266133e-01 -3.6542740e-01]
     [-1.8069600e+00  5.3392905e-01]
     [-1.3644333e+00 -1.1136743e+00]
     [ 6.7694443e-01  1.4711192e-01]
     [ 1.0519712e-03  8.9482183e-04]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.700677   -0.06775361  4.284785    1.05794    -1.5565339   7.239604
     -3.7892644   4.546318    5.5962725   3.363879  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.7900616  -0.966023  ]
     [-1.4949576  -0.84352285]
     [-0.82602984 -1.9944826 ]
     [-1.4403865  -0.38114733]
     [ 0.51821786 -0.5073624 ]
     [-1.233005    0.06162354]
     [ 2.5262444   0.5128169 ]
     [-0.3037018  -2.3471334 ]
     [-0.6161874   0.14489062]
     [ 1.9358184   0.46926937]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 6.9214582  2.9680927  9.3649845  2.7350864  6.1624904  2.3378344
      8.186273  12.362589   0.408154   5.0306363], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.4134428   0.8369157 ]
     [ 1.5634087   0.96661407]
     [-1.5381662   0.02854568]
     [ 1.6918306  -0.2605835 ]
     [-0.36560583  0.6957641 ]
     [-0.4226114  -0.43422127]
     [ 0.14054959  0.36727226]
     [-1.4890147  -0.28067312]
     [ 1.6473944  -1.5113853 ]
     [-0.181554   -0.25972718]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 2.141828   1.8347316  0.6169417  8.040852   1.8479066  4.0410404
      3.0800934  3.1115417 12.928752   4.303286 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.18912603  0.39726517]
     [ 0.9421378   0.2320613 ]
     [ 0.36907473  1.0189105 ]
     [-1.7501806   0.9354308 ]
     [-1.8550951   0.50876635]
     [ 0.6335279   2.0175557 ]
     [ 0.7148584  -0.49643326]
     [-1.3495876  -0.6547662 ]
     [-0.63116     0.3522098 ]
     [ 0.8388691  -0.45030686]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.6503463  5.6281447  1.9580705 -2.4421923 -1.337485  -2.3545017
      6.2998066  3.213673   1.5465959  8.9657755], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.50479823  0.29111743]
     [-0.4878013   0.6113682 ]
     [-0.23620985 -0.8288272 ]
     [-1.2927668  -0.6548326 ]
     [-0.2646298   0.02031396]
     [ 1.4849716  -0.7330451 ]
     [ 1.3604785  -1.8585664 ]
     [-0.49633107 -1.0458201 ]
     [ 0.67260534 -2.1901886 ]
     [-1.137282    0.6881142 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.1751537  1.4843835  6.147503   3.0826037  3.1366215  8.200636
     13.462445   7.3966007 11.929857  -2.063243 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.23117465  0.23634319]
     [ 1.1579672   0.66091335]
     [-0.2589724   0.58427143]
     [-0.917475    0.45097405]
     [ 0.17368884 -0.30044514]
     [-1.0571407  -0.29091334]
     [ 0.78325576 -0.31873327]
     [-0.9423376  -0.23532778]
     [-0.3074752  -1.7452841 ]
     [-0.87013066  1.5176102 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.5378485  4.9687963  2.336215   1.2111418  6.553389   1.5904058
      8.194227   4.3953753  9.806209  -2.3234801], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.5900878   0.59823483]
     [ 2.7050092  -0.16337745]
     [ 0.44298676  0.35884732]
     [-0.34166783 -0.5281958 ]
     [-2.305428    1.827695  ]
     [ 0.8765096   0.22395644]
     [-0.7974922  -2.7009778 ]
     [ 0.53022677 -2.3967535 ]
     [ 0.10661129 -0.93970704]
     [-0.00777971  1.4797419 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-0.84772885 11.327703    5.2609997   5.475301   -6.194291    5.193558
     10.495994   14.48555     8.722349   -0.14698601], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.7812756  -1.2006676 ]
     [-0.3165648   0.8652646 ]
     [ 0.9072284  -0.582551  ]
     [ 0.19894038  0.48374382]
     [ 0.6067198  -0.6357178 ]
     [-0.5861644   0.22756279]
     [ 0.1177938   0.5277688 ]
     [-1.1563973   0.12472362]
     [ 1.0355362  -1.282274  ]
     [-0.7700732  -1.1571699 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 5.7219157  1.9529334  8.664574   2.921616   6.7940054  2.2640913
      4.239851   2.7196965 10.429054   5.0270643], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.63362134 -0.97180426]
     [ 1.2602605   1.7926961 ]
     [-0.295565   -0.41808355]
     [-0.07232384 -1.1797152 ]
     [ 0.9413311  -0.01579438]
     [ 0.60271144  0.80122447]
     [ 0.19280358  1.8396676 ]
     [ 0.2889342   1.525946  ]
     [ 0.27279738  1.2254744 ]
     [-0.54269415  1.3529251 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 9.354414    0.71270716  3.684303    6.3997865   5.456821    3.108911
     -2.7415617  -1.0727485  -0.07321596 -0.02438676], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.1529045   0.16095024]
     [ 0.3722824  -0.30266613]
     [ 2.3153818   2.037739  ]
     [-0.43151513  0.34074885]
     [-0.7374527  -0.5966658 ]
     [ 1.42835    -0.23580466]
     [ 1.8309432   1.2685162 ]
     [ 0.4924677   0.35306448]
     [-0.01926501  0.2271192 ]
     [-1.2327967   1.1917456 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 2.037168   7.383423   2.3381903  2.122728   4.7222404  7.7106752
      2.5127544  2.0992444  4.024626  -1.777019 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.02703482 -0.9253851 ]
     [-0.32194665 -0.5737933 ]
     [-0.61968786  0.61984485]
     [-0.35011318 -1.6075039 ]
     [-0.6594745  -0.17596231]
     [-0.9270474   2.1269834 ]
     [ 2.422913    0.71797043]
     [ 0.48949477  0.21423985]
     [ 0.7618564  -0.61007607]
     [ 0.22902548 -1.7502337 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 7.073045    4.713534    0.12329191  9.392627    4.6179585  -4.9167986
      4.959204    3.970787    7.9071555  10.253884  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.3546162  -0.39818385]
     [ 0.18211623  1.7023101 ]
     [-0.19391945 -0.47211674]
     [ 0.18164486  0.35139242]
     [-0.80752915  0.16571636]
     [-1.5373714  -1.3167452 ]
     [ 1.095371    0.29345343]
     [ 0.9563333  -0.8512972 ]
     [-1.0502502   1.2681706 ]
     [-0.11060572  1.084865  ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 6.9262466 -1.590843   6.3371034  3.1812856  3.0014153  6.255096
      4.8913746  8.522181  -2.3808827  2.709883 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.8921033   0.10005754]
     [-0.5369759   1.9909657 ]
     [ 0.40918598  0.5520517 ]
     [-0.29372814 -0.0854549 ]
     [ 1.3796093  -0.27267075]
     [-0.27402592 -0.16168804]
     [-1.0672566  -2.279839  ]
     [ 0.520237   -0.9197422 ]
     [-1.0346496   1.1282125 ]
     [ 1.2078949   0.532464  ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 6.497005  -3.3420663  4.6378994  3.548706   7.9920135  5.1717143
      9.011724   6.890067  -1.2024648  3.3745928], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.97422516  0.8533383 ]
     [-0.98895484  0.46470135]
     [ 0.506256    1.5342449 ]
     [ 1.0673789  -0.58343357]
     [-0.5047444   0.4502867 ]
     [-1.1644975  -0.95272064]
     [ 1.6630228   1.1571323 ]
     [-0.22981511  1.8272122 ]
     [ 0.22911231 -0.65005845]
     [-0.45114648  0.6600349 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-1.428803    0.26793516  0.6970002   7.8139243   0.6178343   3.2162814
      4.874848    0.35738206  4.969332    1.8014263 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.7338184   1.909061  ]
     [-0.16079086  0.95070106]
     [-0.30350307  1.9145722 ]
     [-0.9490667   0.12216105]
     [-0.9469789  -0.14512616]
     [-0.98229355  1.9363911 ]
     [ 0.37333393  0.14095035]
     [ 1.6414232   1.9731404 ]
     [ 2.611613    1.351357  ]
     [ 2.2549517  -0.78764904]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-0.10494298  0.5630841  -4.7458324   2.148911    1.3395586  -4.140485
      4.9738455   0.9077827   3.6214533  12.981353  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.58549374 -0.43019703]
     [-0.53036225  0.32246387]
     [-1.1815771   1.9627115 ]
     [ 0.20463605  0.81995666]
     [ 0.66641575  0.38216165]
     [ 0.14817916  0.05603995]
     [ 0.24728964  0.09659158]
     [ 1.2708577  -0.28842393]
     [ 1.562639    0.29148796]
     [-1.0814221  -0.00518553]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.7796142  2.2735386 -5.848667   2.7999022  2.2449431  4.1912575
      4.6839123  7.4663744  5.4978533  2.4232545], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-2.9632366  -1.136442  ]
     [-0.81326634 -1.5367669 ]
     [ 0.6622327   0.03574222]
     [ 1.0086703  -0.8422781 ]
     [ 1.0838243  -1.5869948 ]
     [-0.91757303  1.535233  ]
     [ 0.7663443  -0.07008845]
     [ 0.02283903 -1.0025924 ]
     [ 0.19953337  0.9284104 ]
     [-0.32016355  0.49102926]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 2.7490444   8.837821    5.377786    8.447885   11.296326   -4.499307
      4.519147    8.891764    0.21003592  1.0832541 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.26491737 -1.0396743 ]
     [ 1.3339446  -2.6236732 ]
     [-0.13180657 -0.09379514]
     [-0.11895887 -2.0937238 ]
     [-0.17450301 -0.21879819]
     [ 1.0091053   0.76276374]
     [-1.576921   -1.6664377 ]
     [-1.6312779   1.1577944 ]
     [ 0.89103234 -1.0746727 ]
     [ 0.6878785  -0.93409836]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 8.632565  15.226604   3.3071702 11.181472   5.074384   1.0878465
      5.356083  -3.895343   9.152347   8.772263 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.26237413 -1.6813517 ]
     [ 0.6256741   0.17901868]
     [-0.40857366  2.9476922 ]
     [-1.533148   -0.9262239 ]
     [-0.96857864  0.97192335]
     [-0.36562607  0.00758593]
     [ 1.7617395   1.497897  ]
     [-1.1235538  -2.631665  ]
     [ 1.8189007  -0.46323577]
     [ 1.5404118   0.6540487 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 9.641308   5.753266  -6.349351   5.205739  -1.2740037  4.8637424
      1.738926  11.386456   7.7173796  3.4348671], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.1941462  -0.7909934 ]
     [ 1.4191401  -1.2799727 ]
     [ 0.4716001   1.1481051 ]
     [-0.17614177  0.88189155]
     [-1.9420743   1.8928695 ]
     [ 1.2407151  -0.14510405]
     [-1.3094846  -0.34520757]
     [-1.0012529  -0.4820135 ]
     [ 1.0012503   3.281549  ]
     [ 0.95622724 -0.92683   ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 9.210033   11.929236   -0.38569272 -0.9795865  -4.138895    6.836462
      4.284361    3.9540918  -2.9890366   8.685371  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.26267374 -1.1918389 ]
     [ 0.8647139  -0.7245096 ]
     [-2.0963008   0.06555777]
     [ 0.44612277  0.14445722]
     [ 0.45960107 -0.19600023]
     [-0.50168765 -0.361682  ]
     [-0.35421646 -1.6088909 ]
     [ 1.8008657   2.0816467 ]
     [-0.87084657  0.11820022]
     [ 0.08256212 -1.066415  ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [9.454014  9.320697  0.7303947 6.1353397 4.8949986 2.8863177 9.07547
     2.5757031 0.6836058 8.189392 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.0455811   0.01292509]
     [ 0.11411378  1.1927226 ]
     [ 0.34868383 -0.68121535]
     [ 0.54073703  0.76692337]
     [ 2.0041397   0.327673  ]
     [-1.001688   -0.5018184 ]
     [ 1.6025344  -0.39584148]
     [ 1.2536826  -0.36287823]
     [ 0.93560064  0.55728835]
     [ 0.13273422 -1.0433413 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 4.80379   -0.673844   7.5774164  3.1580565  6.8080864  4.053108
      8.721511   8.6012745  5.406675   6.58366  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.2031826  -1.1890072 ]
     [-0.42290398  1.16309   ]
     [ 1.2210873   0.92745143]
     [ 1.3103733  -0.7606991 ]
     [-0.6137666   0.55194056]
     [ 0.6913648  -0.27250317]
     [-0.79427665 -1.1119782 ]
     [ 1.1008728   0.91304576]
     [-0.9871025   0.0654851 ]
     [ 0.09539811 -0.6455337 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 6.9760523 -1.051131   2.9096754 10.546115   2.5736697  7.400946
      6.0760355  2.692692   3.9389787  6.5400047], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.7027862   0.65052485]
     [-1.4962049   0.33648196]
     [ 1.0097779  -0.08477888]
     [ 1.4585454   1.2455351 ]
     [ 0.9977833  -2.239291  ]
     [-1.1035523  -1.6477275 ]
     [ 1.3766125  -1.8111589 ]
     [ 1.0623174   1.1784589 ]
     [ 0.36159682  0.04309899]
     [-0.64934427 -0.629992  ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 1.9983137  0.5337818  6.484518   3.2512429 14.5650015  7.2719684
     12.830334   2.9994571  4.157785   4.2607126], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.33103448 -0.4570666 ]
     [-0.32727262  1.3507603 ]
     [-0.0641734   1.0513161 ]
     [ 0.75163835  0.66855055]
     [-1.1230369   0.42015287]
     [-1.3242898   1.7991844 ]
     [ 0.34925848 -0.29203907]
     [-0.43669835 -0.5528801 ]
     [-1.0957952   0.7918297 ]
     [-1.8108495   0.53825605]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 7.366438  -0.3280155  1.8655076  2.5445483 -0.4219455 -4.729942
      5.7228513  5.608009  -1.4056005 -1.152486 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-2.2067997   0.28552693]
     [-0.67945766 -0.07985478]
     [ 1.0064238  -1.1091815 ]
     [-0.20186673  2.3391182 ]
     [-1.5732455  -0.94944185]
     [ 1.1427773   1.4006697 ]
     [ 0.94053537  0.76648116]
     [ 0.1273626  -0.6064322 ]
     [-0.7762303  -1.7049068 ]
     [ 0.03155525  0.04843911]], shape=(10, 2), dtype=float32) tf.Tensor(
    [-1.9617386  5.0402417 11.507214  -3.8051896  4.8099074  2.0362923
      3.8014085 10.06785    8.498152   5.2574363], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-1.0295203  -0.37859878]
     [-0.14801641 -1.3532102 ]
     [-0.2019753  -0.9869329 ]
     [ 0.6871063   0.29376087]
     [-0.45891953 -1.3587801 ]
     [ 0.5587147  -1.3968976 ]
     [ 0.00999943  0.85267663]
     [ 0.7484911   0.08990358]
     [ 0.43141896 -2.2194467 ]
     [ 1.6488645  -0.7827961 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 3.8395038  7.961995   5.6943216  2.825644   7.723135   8.711213
      1.4689591  6.1801724 12.753277  10.430642 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.66641146 -0.04021292]
     [-0.09037361  0.32287145]
     [-0.576591   -1.9081253 ]
     [-1.2819417  -1.6372113 ]
     [-1.8330942   0.5118766 ]
     [ 0.74408704 -0.16255555]
     [ 2.0006783   0.55873954]
     [ 1.0176365  -1.4328758 ]
     [-0.17249027  0.13618127]
     [ 0.00541021  0.66792595]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 5.678484   1.6911619  9.929013   7.5281744 -1.0362754  6.748052
      6.5568895 12.204106   3.3989425  3.362786 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.7645566  -1.58005   ]
     [-0.7433181  -1.0591115 ]
     [-0.51891226  0.32044575]
     [-0.3659127   0.44851917]
     [-0.14983067  0.9497839 ]
     [ 0.2582865  -0.45510292]
     [ 1.8673171  -1.6966611 ]
     [-0.41145274 -0.5592163 ]
     [ 1.2616956   1.6701833 ]
     [ 0.44747823  0.6419982 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 9.457498    6.608444    2.3762789   3.219202   -0.59400094  6.7754426
     15.766202    4.987531    0.13775998  3.688607  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 1.5352244   0.77402145]
     [-0.81668085  0.34120774]
     [-0.40331843  1.3592064 ]
     [-0.7051121   1.061686  ]
     [ 0.31645063 -1.4349946 ]
     [-2.5146818  -0.3469496 ]
     [ 0.9630304  -0.7846659 ]
     [ 0.4800891  -0.57663804]
     [-0.87379074  0.4101443 ]
     [ 0.31076372 -0.9527218 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 4.380649    0.1621368  -0.36972147 -1.8190713   8.446265   -1.0783951
      9.345976    6.3071504   1.5747502   8.668073  ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[-0.99068487  0.15301767]
     [-0.5839435   1.8867966 ]
     [-0.49854344  0.10373242]
     [ 0.70624477 -0.30522352]
     [-0.6089625   0.34780857]
     [ 0.4586247  -0.72997206]
     [-0.3864532  -0.06147041]
     [ 0.95875186  0.08800002]
     [-1.6670251  -1.7113945 ]
     [-0.8572962   0.6241738 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 2.8463817  -3.1350913   2.0774372   8.190796    0.31565714  8.19213
      5.608857    4.92479     5.8811235  -0.26806116], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.43319285 -0.54127645]
     [ 1.3625897  -0.29920283]
     [ 0.44859636  0.07579826]
     [-1.1840209  -0.8367317 ]
     [-1.2697277  -0.0854771 ]
     [-0.99083626  1.4015459 ]
     [ 1.379629    0.58301973]
     [ 0.76514983  0.47459012]
     [-0.07372255 -0.8801853 ]
     [ 2.022686   -1.20094   ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [ 6.78409    7.1633577  6.027401   4.3552456  3.8393002 -2.1820557
      3.3424532  2.9511633  6.546323  12.942073 ], shape=(10,), dtype=float32)
    tf.Tensor(
    [[ 0.82960016  0.97341305]
     [-0.8293571  -0.6158197 ]
     [-0.699426   -0.03063298]
     [ 1.399633    0.00592529]
     [ 0.63437927 -0.55495566]
     [ 1.2378341  -0.01843788]
     [ 0.42736176  0.6621422 ]
     [-0.6884833  -0.03707427]
     [ 0.00950729 -0.38044465]
     [ 0.5323544   0.8310433 ]], shape=(10, 2), dtype=float32) tf.Tensor(
    [3.1026866 5.172667  2.3483632 5.529105  6.6496353 6.5766068 2.3282762
     3.1513815 6.6192627 3.978592 ], shape=(10,), dtype=float32)
    

定义模型,tensorflow 2.0推荐使用keras定义网络，故使用keras定义网络
我们先定义一个模型变量`model`，它是一个`Sequential`实例。
在keras中，`Sequential`实例可以看作是一个串联各个层的容器。
在构造模型时，我们在该容器中依次添加层。
当给定输入数据时，容器中的每一层将依次计算并将输出作为下一层的输入。
重要的一点是，在keras中我们无须指定每一层输入的形状。
因为为线性回归，输入层与输出层全连接，故定义一层


```python
from tensorflow import keras
model = keras.Sequential()
model.add(keras.layers.Dense(1))
```

定义损失函数和优化器：损失函数为mse，优化器选择sgd随机梯度下降
在keras中，定义完模型后，调用`compile()`方法可以配置模型的损失函数和优化方法。定义损失函数只需传入`loss`的参数，keras定义了各种损失函数，并直接使用它提供的平方损失`mse`作为模型的损失函数。同样，我们也无须实现小批量随机梯度下降，只需传入`optimizer`的参数，keras定义了各种优化算法，我们这里直接指定学习率为0.01的小批量随机梯度下降`tf.keras.optimizers.SGD(0.03)`为优化算法


```python
model.compile(optimizer=tf.keras.optimizers.SGD(0.01),
              loss='mse')
```

在使用keras训练模型时，我们通过调用`model`实例的`fit`函数来迭代模型。`fit`函数只需传入你的输入x和输出y，还有epoch遍历数据的次数，每次更新梯度的大小batch_size, 这里定义epoch=3，batch_size=10。
使用keras甚至完全不需要去划分数据集


```python
model.fit(features,labels,epochs=3, batch_size=10)
```

    Train on 1000 samples
    Epoch 1/3
    1000/1000 [==============================] - 1s 539us/sample - loss: 7.7055
    Epoch 2/3
    1000/1000 [==============================] - 0s 299us/sample - loss: 1.1189
    Epoch 3/3
    1000/1000 [==============================] - 0s 317us/sample - loss: 0.9965
    




    <tensorflow.python.keras.callbacks.History at 0x4494e84470>



下面我们分别比较学到的模型参数和真实的模型参数。我们可以通过model的`get_weights()`来获得其权重（`weight`）和偏差（`bias`）。学到的参数和真实的参数很接近。


```python
true_w, model.get_weights()[0]
```




    ([2, -3.4], array([[ 2.0131052],
            [-3.3579836]], dtype=float32))




```python
true_b, model.get_weights()[1]
```




    (4.2, array([4.1498914], dtype=float32))




```python

```
